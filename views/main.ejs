<!--
=========================================================
Material Kit - v2.0.7
=========================================================

Product Page: https://www.creative-tim.com/product/material-kit
Copyright 2020 Creative Tim (https://www.creative-tim.com/)

Coded by Creative Tim

=========================================================

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="img/apple-icon.png" />
    <link rel="icon" type="image/png" href="img/favicon.png" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>
      Song PAY
    </title>
    <meta
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
      name="viewport"
    />
    <!--     Fonts and icons     -->

    <link
      rel="stylesheet"
      type="text/css"
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css"
    />
    <!-- CSS Files -->
    <link href="css/material-kit.css?v=2.0.7" rel="stylesheet" />
    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link href="demo/demo.css" rel="stylesheet" />

    <style>
      .wrap {
        position: absolute;
        left: 0;
        bottom: 40px;
        width: 288px;
        height: 132px;
        margin-left: -144px;
        text-align: left;
        overflow: hidden;
        font-size: 12px;
        font-family: 'Malgun Gothic', dotum, '돋움', sans-serif;
        line-height: 1.5;
      }
      .wrap * {
        padding: 0;
        margin: 0;
      }
      .wrap .info {
        width: 286px;
        height: 120px;
        border-radius: 5px;
        border-bottom: 2px solid #ccc;
        border-right: 1px solid #ccc;
        overflow: hidden;
        background: #fff;
      }
      .wrap .info:nth-child(1) {
        border: 0;
        box-shadow: 0px 1px 2px #888;
      }
      .info .title {
        padding: 5px 0 0 10px;
        height: 30px;
        background: #eee;
        border-bottom: 1px solid #ddd;
        font-size: 18px;
        font-weight: bold;
      }
      .info .close {
        position: absolute;
        top: 10px;
        right: 10px;
        color: #888;
        width: 17px;
        height: 17px;
        background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/overlay_close.png');
      }
      .info .close:hover {
        cursor: pointer;
      }
      .info .body {
        position: relative;
        overflow: hidden;
      }
      .info .desc {
        position: relative;
        margin: 13px 0 0 90px;
        height: 75px;
      }
      .desc .ellipsis {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .desc .jibun {
        font-size: 11px;
        color: #888;
        margin-top: -2px;
      }
      .info .img {
        position: absolute;
        top: 6px;
        left: 5px;
        width: 73px;
        height: 71px;
        border: 1px solid #ddd;
        color: #888;
        overflow: hidden;
      }
      .info:after {
        content: '';
        position: absolute;
        margin-left: -12px;
        left: 50%;
        bottom: 0;
        width: 22px;
        height: 12px;
        background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/vertex_white.png');
      }
      .info .link {
        color: #5085bb;
      }
    </style>
  </head>

  <body class="landing-page sidebar-collapse">
    <nav
      class="navbar navbar-transparent navbar-color-on-scroll fixed-top navbar-expand-lg"
      color-on-scroll="100"
      id="sectionsNav"
    >
      <div class="container">
        <div class="navbar-translate">
          <a class="navbar-brand">
            Song PAY
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" target="_blank">
                쏭페이
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" target="_blank">
                마이페이지
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <nav
      class="navbar navbar-transparent navbar-color-on-scroll fixed-top navbar-expand-lg"
      color-on-scroll="100"
      id="sectionsNav"
    >
      <div class="container">
        <div class="navbar-translate">
          <a
            class="navbar-brand"
            href="/main"
          >
            Song PAY
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" target="_blank">
                쏭페이
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/myroom" target="_blank">
                마이페이지
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div
      class="page-header header-filter"
      data-parallax="true"
      style="background-image: url('img/main.jpg');"
    >
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <h1 class="title">Song PAY</h1>
            <hr />
            <h2>'쏭페이'는</h2>
            <h4 style="font-size: 50px;">
              쏭페이는 코인노래방 <br>
              간편 결제 서비스입니다.
            </h4>
            <br />
          </div>
        </div>
      </div>
    </div>
    <div class="main main-raised">
      <div class="container">
        <div class="section text-center">
          <div class="row">
            <div class="col-md-8 ml-auto mr-auto">
              <h2 class="title">매장 찾기</h2>
              <h5 class="description">
                매장을 찾아보세요!
              </h5>
            </div>
          </div>
          <div id="map" style="width: 100%; height: 400px;"></div>
          <script
            type="text/javascript"
            src="//dapi.kakao.com/v2/maps/sdk.js?appkey=45a6a484ac18febdb3ff9844bb482926"
          ></script>
          <script>
            var mapContainer = document.getElementById('map'), // 지도를 표시할 div  
    mapOption = { 
        center: new kakao.maps.LatLng(37.51988798087435, 126.853394952582), // 지도의 중심좌표
        level: 9 // 지도의 확대 레벨
    };

var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
 
// 마커를 표시할 위치와 title 객체 배열입니다 
var positions = [
    {
        title: 'Store1', 
        latlng: new kakao.maps.LatLng(37.5961452809497, 127.060299882482)
    },
    {
        title: 'Store2', 
        latlng: new kakao.maps.LatLng(37.54497293640308, 126.9668368451944)
    },
    {
        title: 'Store3', 
        latlng: new kakao.maps.LatLng(37.59188354020091, 127.0519078870364)
    },
    {
        title: 'Store4',
        latlng: new kakao.maps.LatLng(37.579044106645966, 127.07049706608025)
    },
    {
        title: 'Store5', 
        latlng: new kakao.maps.LatLng(37.5408636052108, 127.0707877525661)
    },
    {
        title: 'Store6', 
        latlng: new kakao.maps.LatLng(37.56070511054409, 127.03307630302811)
    },
    {
        title: 'Store7', 
        latlng: new kakao.maps.LatLng(37.55874908758164, 126.9248144756333)
    },
    {
        title: 'Store8',
        latlng: new kakao.maps.LatLng(37.48771613055148, 126.98101971764825)
    },
    {
        title: 'Store9',
        latlng: new kakao.maps.LatLng(37.51988798087435, 126.853394952582)
    }
];

// 마커 이미지의 이미지 주소입니다
var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png"; 
    
for (var i = 0; i < positions.length; i ++) {
    
    // 마커 이미지의 이미지 크기 입니다
    var imageSize = new kakao.maps.Size(24, 35); 
    
    // 마커 이미지를 생성합니다    
    var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize); 
    
    // 마커를 생성합니다
    var marker = new kakao.maps.Marker({
        map: map, // 마커를 표시할 지도
        position: positions[i].latlng, // 마커를 표시할 위치
        title : positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
        image : markerImage // 마커 이미지 
    });
}

            // 커스텀 오버레이에 표시할 컨텐츠 입니다
            // 커스텀 오버레이는 아래와 같이 사용자가 자유롭게 컨텐츠를 구성하고 이벤트를 제어할 수 있기 때문에
            // 별도의 이벤트 메소드를 제공하지 않습니다
            var content =
              '<div class="wrap">' +
              '    <div class="info">' +
              '        <div class="title">' +
              '            락휴 노래방' +
              '            <div class="close" onclick="closeOverlay()" title="닫기"></div>' +
              '        </div>' +
              '        <button data-toggle="modal" data-target="#payModal" style="width:100%">' +
              '        <div class="body">' +
              '            <div class="img">' +
              '                <img src="img/rockyou.png" width="73" height="70">' +
              '           </div>' +  
              '            <div class="desc">' +
              '                <div class="ellipsis">서울특별시 용산구 사가정로</div>' +
              '                <div class="jibun ellipsis">락휴 용산점</div>' +
              '            </div>' +
              '        </div>' +
              '         </button>';
            '  </div>' + '</div>';

            // 마커 위에 커스텀오버레이를 표시합니다
            // 마커를 중심으로 커스텀 오버레이를 표시하기위해 CSS를 이용해 위치를 설정했습니다
            var overlay = new kakao.maps.CustomOverlay({
              content: content,
              map: map,
              position: marker.getPosition(),
            });

            // 마커를 클릭했을 때 커스텀 오버레이를 표시합니다
            kakao.maps.event.addListener(marker, 'click', function () {
              overlay.setMap(map);
            });

            // 커스텀 오버레이를 닫기 위해 호출되는 함수입니다
            function closeOverlay() {
              overlay.setMap(null);
            }
          </script>
        </div>
      </div>
    </div>

    <!-- Classic Modal -->
    <div class="modal fade" id="selectModal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title">방을 선택해주세요!</h3>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <i class="material-icons">clear</i>
            </button>
          </div>
          <div class="modal-body">
            <img
              src="img/modal1.png"
              style="width: 100%; height: 100%;"
              usemap="#Map"
            />
            <map name="Map">
              <area
                shape="rect"
                coords="0,0,400,400"
                data-toggle="modal"
                data-target="#payModal"
              />
            </map>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger btn-link"
              data-dismiss="modal"
            >
              닫기
            </button>
          </div>
        </div>
      </div>
    </div>
    <!--  End Modal -->

    <!-- Classic Modal -->
    <div class="modal fade" id="payModal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title">결제 진행</h3>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <i class="material-icons">clear</i>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
            <form>
                <label for="profit">출금 금액을 선택하세요</label>
                <select class="form-control" id="selectBox" name="profit">
                  <option value="1000">1,000</option>
                  <option value="2000">2,000</option>
                  <option value="3000">3,000</option>
                  <option value="4000">4,000</option>
                  <option value="5000">5,000</option>
                  <option value="6000">6,000</option>
                  <option value="7000">7,000</option>
                  <option value="8000">8,000</option>
                  <option value="9000">9,000</option>
                  <option value="10000">10,000</option>
                </select>
            </form>
            </div>
            </script>
            <h4 id="pay"></h4>
            <h3>입금계좌</h3>
            <li class="dropdown nav-item" style="list-style: none;">
              <a
                href="javascript:;"
                class="dropdown-toggle nav-link"
                data-toggle="dropdown"
                >계좌선택</a
              >
              <div class="dropdown-menu">
                <h6 class="dropdown-header">내 계좌 목록</h6>
                <a href="javascript:;" class="dropdown-item">123-41234-1234</a>
              </div>
            </li>
          </div>
          <div class="modal-footer">
            <button type="button" id="submitBtn" class="btn btn-link">결제하기</button>
            <button
              type="button"
              class="btn btn-danger btn-link"
              data-dismiss="modal"
            >
              닫기
            </button>
          </div>
        </div>
      </div>
    </div>
    <!--  End Modal -->

    <footer class="footer footer-default">
      <div class="container">
        <nav class="float-left">
          <ul>
            <li>
              <a href="https://www.creative-tim.com/">
                Creative Tim
              </a>
            </li>
            <li>
              <a href="https://www.creative-tim.com/presentation">
                About Us
              </a>
            </li>
            <li>
              <a href="https://www.creative-tim.com/blog">
                Blog
              </a>
            </li>
            <li>
              <a href="https://www.creative-tim.com/license">
                Licenses
              </a>
            </li>
          </ul>
        </nav>
        <div class="copyright float-right">
          &copy;
          <script>
            document.write(new Date().getFullYear());
          </script>
          , made with <i class="material-icons">favorite</i> by
          <a href="https://www.creative-tim.com/" target="_blank"
            >Creative Tim</a
          >
          for a better web.
        </div>
      </div>
    </footer>
    <!--   Core JS Files   -->
    <script src="js/core/popper.min.js" type="text/javascript"></script>
    <script src="js/core/jquery.min.js" type="text/javascript"></script>
    <script
      src="js/core/bootstrap-material-design.min.js"
      type="text/javascript"
    ></script>
    <script src="js/plugins/moment.min.js"></script>
    <!--	Plugin for the Datepicker, full documentation here: https://github.com/Eonasdan/bootstrap-datetimepicker -->
    <script
      src="js/plugins/bootstrap-datetimepicker.js"
      type="text/javascript"
    ></script>
    <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
    <script src="js/plugins/nouislider.min.js" type="text/javascript"></script>
    <!--  Google Maps Plugin    -->
    <!-- Control Center for Material Kit: parallax effects, scripts for the example pages etc -->
    <script src="js/material-kit.js?v=2.0.7" type="text/javascript"></script>
  </body>
</html>

<script>
  var jwtToken = sessionStorage.getItem('jwtToken');
  fetchUserData();
  function fetchUserData() {
    $.ajax({
      url: 'http://localhost:3000/list',
      type: 'POST',

      headers: {
        ourtoken: jwtToken,
      },
      success: function (data) {
        console.log(data.res_list);
        for (var i = 0; i < data.res_list.length; i++) {
          $('#cardList').append(
            '<div class="balance-card mb-15">' +
              i +
              '<div class="d-flex align-items-center">' +
              '<div class="d-flex flex-grow">' +
              '<div class="mr-auto">' +
              '<h1 class="b-val">' +
              data.res_list[i].account_alias +
              '</h1>' +
              '<p class="g-text mb-10">' +
              data.res_list[i].fintech_use_num +
              '</p>' +
              '</div>' +
              '<div class="ml-auto align-self-end">' +
              '<a href="/balance?fin_use_num=' +
              data.res_list[i].fintech_use_num +
              '">잔액조회</a>' +
              '||||' +
              '<a href="/qrcode?fin_use_num=' +
              data.res_list[i].fintech_use_num +
              '">QR생성</a>' +
              '</div>' +
              '</div>' +
              '</div>' +
              '</div>'
          );
        }
      },
    });
  }

      $("#submitBtn").click(function(){
        var profit = $("#selectBox option:selected").val();
       
        console.log(profit + "입니다.");
        $.ajax({
            url:'http://localhost:3000/withdraw',
            type : 'POST',
            data : {
                profit : profit,
            },
            success:function(data){
                if(data =='1'){
                    window.location.href='/myroom?profit='+ profit;
                }
                else{
                    alert('fail…..');
                }
            }
        })
    })

    
</script>
